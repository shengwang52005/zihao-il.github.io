import{s as M,q as G,g as H,h as Y,p as Z,B as ee,C as te,i as ae,k as ne,w as oe,D as se,E as le,e as re,y as ie,z as ue,r as ce,d as _e,t as me,A as pe}from"./@varlet-ea2585a9.js";import{s as ve,g as de}from"./index-0102211e.js";import{u as fe}from"./utcTime-740379fe.js";import{_ as ge}from"./_plugin-vue_export-helper-c27b6911.js";import{r as ke,b as u,o as be,z as w,M as E,s as n,I as a,u as L,i as y,F as T,Q as i,N as Ce,J as I,A as Ie,B as he,L as we}from"./@vue-9130076e.js";import"./@popperjs-b31fb82b.js";import"./axios-47b9d439.js";const ye={__name:"download",setup(Se){const g=ke([]);let c=u(!1);const k=u(!0);async function S(t,e){const s=JSON.parse(t.link),l=Object.keys(s);l.reverse();const v=l.map(C=>({name:C,icon:"download"})),r=await ue({actions:v,title:"下载推荐(OneDrive_365>OneDrive_E5>123盘)"});r!=="close"&&(e==="v7"?window.open(s[r.name].ARMv7,"_blank"):s[r.name].ARMv8===""?M.warning("此版本没有ARMv8架构的安装包(>≈1.16.X版本才有)"):window.open(s[r.name].ARMv8,"_blank"))}async function d(t,e,s){let l;if(s===!0){const{data:r}=await ve(t);if(r.status===201)return M.error("无此版本号！");l=r.message}else try{const{data:r}=await de(t);l=r.message,k.value=!1}catch{c.value=!0,m.value=!1,f.value=!0;return}const v=u(l.slice().reverse());e===!0?g.splice(0,g.length,...v.value):g.push(...v.value)}be(()=>{let t=setInterval(function(){let e=sessionStorage.getItem("Beta");e!==null&&(clearInterval(t),d({v:e}),sessionStorage.setItem("version",e))},100)});const p=u("");u("");let _=u(!0);function D(){_.value=_.value===!1}const $=()=>{switch(b.value){case"全版本":case 0:sessionStorage.setItem("version",sessionStorage.getItem("Beta"));break;case"正式版":case 1:sessionStorage.setItem("version",sessionStorage.getItem("Release"));break;case"测试版":case 2:sessionStorage.setItem("version",sessionStorage.getItem("Beta"));break}};function U(){k.value=!0;let t,e;switch(b.value){case"全版本":e="2";break;case"正式版":e="0";break;case"测试版":e="1";break}p.value!==""?p.value.split(".")[1]&&(_.value===!0?t="1":t="0",d({s:p.value,m:t,b:e},!0,!0),k.value=!1,m.value=!1,f.value=!0):($(),m.value=!0,f.value=!1,d({v:sessionStorage.getItem("version"),b:e},!0,!1),B())}const b=u(0),h=(t,e)=>{sessionStorage.setItem("isBeta",t),d({v:sessionStorage.getItem(e),b:t},!0),sessionStorage.setItem("version",sessionStorage.getItem(e))};function z(t){switch(p.value="",sessionStorage.setItem("version",sessionStorage.getItem("Beta")),t){case"全版本":h("","Beta");break;case"正式版":h("0","Release");break;case"测试版":h("1","Beta");break}}const m=u(!1);u(!1),u([]);const f=u(!1);function B(){setTimeout(()=>{let t=sessionStorage.getItem("isBeta"),e=sessionStorage.getItem("version");if(e==="1.2.x"){m.value=!1,f.value=!0;return}let s=parseInt(e.split(".")[1])-1;s=`1.${s}.x`,sessionStorage.setItem("version",s);let l;t===""?l={v:s}:l={v:s,b:t},d(l),m.value=!1},1e3)}const N=t=>{const e=t.split(".");let s=`${e[0]}.${e[1]}`;return parseFloat(s)>1.1?`https://minecraft.fandom.com/zh/wiki/%E5%9F%BA%E5%B2%A9%E7%89%88${t}`:`https://minecraft.fandom.com/zh/wiki/%E6%90%BA%E5%B8%A6%E7%89%88${t}`},F=t=>fe(t);return(t,e)=>{const s=Z,l=G,v=ee,r=te,C=ae,x=ne,A=ce,R=_e,V=me,O=pe,P=oe,j=se,J=le,q=H,K=re,Q=ie,W=Y;return w(),E(T,null,[n(l,{active:b.value,"onUpdate:active":e[0]||(e[0]=o=>b.value=o),onClick:z},{default:a(()=>[n(s,{name:"全版本"},{default:a(()=>[i("全版本")]),_:1}),n(s,{name:"正式版"},{default:a(()=>[i("正式版")]),_:1}),n(s,{name:"测试版"},{default:a(()=>[i("测试版")]),_:1})]),_:1},8,["active"]),n(q,{justify:"center",gutter:10},{default:a(()=>[n(C,{span:22},{default:a(()=>[n(v,{variant:"outlined",placeholder:"请输入版本号",onInput:U,modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=o=>p.value=o)},null,8,["modelValue"]),n(r,{onClick:D,modelValue:L(_),"onUpdate:modelValue":e[2]||(e[2]=o=>y(_)?_.value=o:_=o),class:"mSwitch"},{default:a(()=>[i("模糊搜索")]),_:1},8,["modelValue"])]),_:1}),n(j,{"loading-text":"正在努力输出中...","finished-text":"一滴都没有了","error-text":"出错了出错了",finished:f.value,offset:"30",loading:m.value,"onUpdate:loading":e[3]||(e[3]=o=>m.value=o),check:"",onLoad:B},{default:a(()=>[n(P,{title:"",card:"",rows:3,loading:k.value},{default:a(()=>[(w(!0),E(T,null,Ce(g,o=>(w(),Ie(C,{key:o.version_all},{default:a(()=>[n(O,{title:o.version,subtitle:o.is_beta===0?"正式版":"测试版",layout:"column",ripple:"",outline:"outline",class:he(o.is_beta===0?"cardr":"cardb")},{description:a(()=>[n(A,null,{default:a(()=>[I("ul",null,[I("li",null,[i("更新日志： "),n(x,{type:"primary",target:"_blank",href:N(o.version),underline:"none"},{default:a(()=>[i("Minecraft Wiki ")]),_:2},1032,["href"])]),I("li",null," 更新时间："+we(F(o.update_time)),1)])]),_:2},1024)]),extra:a(()=>[n(A,null,{default:a(()=>[n(V,{plain:"",onClick:X=>S(o,"v7"),type:"primary"},{right:a(()=>[n(R,{name:"download"})]),default:a(()=>[i(" ARMv7 ")]),_:2},1032,["onClick"]),n(V,{plain:"",onClick:X=>S(o,"v8"),type:"primary"},{right:a(()=>[n(R,{name:"download"})]),default:a(()=>[i(" ARMv8 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["title","subtitle","class"])]),_:2},1024))),128))]),_:1},8,["loading"])]),_:1},8,["finished","loading"]),n(J,{duration:300})]),_:1}),n(W,{"default-style":!1,show:L(c),"onUpdate:show":e[5]||(e[5]=o=>y(c)?c.value=o:c=o)},{default:a(()=>[n(Q,{class:"result",type:"empty",title:"无法获取版本列表"},{description:a(()=>[I("p",null,[i(" 请前往 "),n(x,{class:"href-link",type:"primary",target:"_blank",href:"https://mc233.endyun.ltd/",underline:"none"},{default:a(()=>[i("静态站 ")]),_:1}),i(" 或联系管理员修复！ ")])]),footer:a(()=>[n(K,{color:"var(--result-empty-color)","text-color":"#fff",onClick:e[4]||(e[4]=o=>y(c)?c.value=!1:c=!1)},{default:a(()=>[i(" 知道了 ")]),_:1})]),_:1})]),_:1},8,["show"])],64)}}},Le=ge(ye,[["__scopeId","data-v-cd119c5b"]]);export{Le as default};
