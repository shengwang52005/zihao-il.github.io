import{s as M,q as H,g as Y,h as Z,p as ee,B as te,C as ae,i as ne,k as oe,w as se,D as le,E as re,e as ie,y as ue,z as ce,r as _e,d as me,t as pe,A as ve}from"./@varlet-ea2585a9.js";import{s as de,g as fe}from"./index-0102211e.js";import{u as ge}from"./utcTime-e41a6f4a.js";import{_ as ke}from"./_plugin-vue_export-helper-c27b6911.js";import{r as be,b as i,o as Ce,z as h,M as E,s as n,I as a,u as L,i as y,F as T,Q as r,N as we,J as g,A as Ie,B as he,L as D}from"./@vue-9130076e.js";import"./@popperjs-b31fb82b.js";import"./axios-47b9d439.js";const ye={__name:"download",setup(Se){const k=be([]);let c=i(!1);const b=i(!0);async function S(t,e){const s=JSON.parse(t.link),l=Object.keys(s);l.reverse();const u=l.map(w=>({name:w,icon:"download"})),v=await ce({actions:u,title:"下载推荐(OneDrive_365>OneDrive_E5>123盘)"});v!=="close"&&(e==="v7"?window.open(s[v.name].ARMv7,"_blank"):s[v.name].ARMv8===""?M.warning("此版本没有ARMv8架构的安装包(>≈1.16.X版本才有)"):window.open(s[v.name].ARMv8,"_blank"))}async function d(t,e,s){let l;if(s===!0){const{data:u}=await de(t);if(u.status===201)return M.error("无此版本号！");l=u.message}else try{const{data:u}=await fe(t);l=u.message,b.value=!1}catch{c.value=!0,m.value=!1,f.value=!0;return}e===!0?k.splice(0,k.length,...l):k.push(...l)}Ce(()=>{let t=setInterval(function(){let e=sessionStorage.getItem("Beta");e!==null&&(clearInterval(t),d({v:e}),sessionStorage.setItem("version",e))},100)});const p=i("");i("");let _=i(!0);function $(){_.value=_.value===!1}const z=()=>{switch(C.value){case"全版本":case 0:sessionStorage.setItem("version",sessionStorage.getItem("Beta"));break;case"正式版":case 1:sessionStorage.setItem("version",sessionStorage.getItem("Release"));break;case"测试版":case 2:sessionStorage.setItem("version",sessionStorage.getItem("Beta"));break}};function U(){b.value=!0;let t,e;switch(C.value){case"全版本":e="2";break;case"正式版":e="0";break;case"测试版":e="1";break}p.value!==""?p.value.split(".")[1]&&(_.value===!0?t="1":t="0",d({s:p.value,m:t,b:e},!0,!0),b.value=!1,m.value=!1,f.value=!0):(z(),m.value=!0,f.value=!1,d({v:sessionStorage.getItem("version"),b:e},!0,!1),B())}const C=i(0),I=(t,e)=>{sessionStorage.setItem("isBeta",t),d({v:sessionStorage.getItem(e),b:t},!0),sessionStorage.setItem("version",sessionStorage.getItem(e))};function N(t){switch(p.value="",sessionStorage.setItem("version",sessionStorage.getItem("Beta")),t){case"全版本":I("","Beta");break;case"正式版":I("0","Release");break;case"测试版":I("1","Beta");break}}const m=i(!1);i(!1),i([]);const f=i(!1);function B(){setTimeout(()=>{let t=sessionStorage.getItem("isBeta"),e=sessionStorage.getItem("version");if(e==="1.2.x"){m.value=!1,f.value=!0;return}let s=parseInt(e.split(".")[1])-1;s=`1.${s}.x`,sessionStorage.setItem("version",s);let l;t===""?l={v:s}:l={v:s,b:t},d(l),m.value=!1},1e3)}const F=t=>{const e=t.split(".");let s=`${e[0]}.${e[1]}`;return parseFloat(s)>1.1?`https://zh.minecraft.wiki/w/%E5%9F%BA%E5%B2%A9%E7%89%88${t}`:`https://zh.minecraft.wiki/w/%E6%90%BA%E5%B8%A6%E7%89%88${t}`},O=t=>ge(t);return(t,e)=>{const s=ee,l=H,u=te,v=ae,w=ne,x=oe,A=_e,R=me,V=pe,P=ve,j=se,J=le,q=re,K=Y,Q=ie,W=ue,X=Z;return h(),E(T,null,[n(l,{active:C.value,"onUpdate:active":e[0]||(e[0]=o=>C.value=o),onClick:N},{default:a(()=>[n(s,{name:"全版本"},{default:a(()=>[r("全版本")]),_:1}),n(s,{name:"正式版"},{default:a(()=>[r("正式版")]),_:1}),n(s,{name:"测试版"},{default:a(()=>[r("测试版")]),_:1})]),_:1},8,["active"]),n(K,{justify:"center",gutter:10},{default:a(()=>[n(w,{span:22},{default:a(()=>[n(u,{variant:"outlined",placeholder:"请输入版本号",onInput:U,modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=o=>p.value=o)},null,8,["modelValue"]),n(v,{onClick:$,modelValue:L(_),"onUpdate:modelValue":e[2]||(e[2]=o=>y(_)?_.value=o:_=o),class:"mSwitch"},{default:a(()=>[r("模糊搜索")]),_:1},8,["modelValue"])]),_:1}),n(J,{"loading-text":"正在努力输出中...","finished-text":"一滴都没有了","error-text":"出错了出错了",finished:f.value,offset:"30",loading:m.value,"onUpdate:loading":e[3]||(e[3]=o=>m.value=o),check:"",onLoad:B},{default:a(()=>[n(j,{title:"",card:"",rows:3,loading:b.value},{default:a(()=>[(h(!0),E(T,null,we(k,o=>(h(),Ie(w,{key:o.version_all},{default:a(()=>[n(P,{title:o.version,subtitle:o.is_beta===0?"正式版":"测试版",layout:"column",ripple:"",outline:"outline",class:he(o.is_beta===0?"cardr":"cardb")},{description:a(()=>[n(A,null,{default:a(()=>[g("ul",null,[g("li",null,[r("更新日志： "),n(x,{type:"primary",target:"_blank",href:F(o.version),underline:"none"},{default:a(()=>[r("Minecraft Wiki ")]),_:2},1032,["href"])]),g("li",null," 更新时间："+D(O(o.update_time)),1),g("li",null," 文件大小："+D(o.file_size),1)])]),_:2},1024)]),extra:a(()=>[n(A,null,{default:a(()=>[n(V,{plain:"",onClick:G=>S(o,"v7"),type:"primary"},{right:a(()=>[n(R,{name:"download"})]),default:a(()=>[r(" ARMv7 ")]),_:2},1032,["onClick"]),n(V,{plain:"",onClick:G=>S(o,"v8"),type:"primary"},{right:a(()=>[n(R,{name:"download"})]),default:a(()=>[r(" ARMv8 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["title","subtitle","class"])]),_:2},1024))),128))]),_:1},8,["loading"])]),_:1},8,["finished","loading"]),n(q,{duration:300})]),_:1}),n(X,{"default-style":!1,show:L(c),"onUpdate:show":e[5]||(e[5]=o=>y(c)?c.value=o:c=o)},{default:a(()=>[n(W,{class:"result",type:"empty",title:"无法获取版本列表"},{description:a(()=>[g("p",null,[r(" 请前往 "),n(x,{class:"href-link",type:"primary",target:"_blank",href:"https://mc233.endyun.ltd/",underline:"none"},{default:a(()=>[r("静态站 ")]),_:1}),r(" 或联系管理员修复！ ")])]),footer:a(()=>[n(Q,{color:"var(--result-empty-color)","text-color":"#fff",onClick:e[4]||(e[4]=o=>y(c)?c.value=!1:c=!1)},{default:a(()=>[r(" 知道了 ")]),_:1})]),_:1})]),_:1},8,["show"])],64)}}},Le=ke(ye,[["__scopeId","data-v-92e6d533"]]);export{Le as default};
